<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>搭建Taro3组件库 | JR-Blog</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Just playing around.">
    
    <link rel="preload" href="/myblog/assets/css/0.styles.318df977.css" as="style"><link rel="preload" href="/myblog/assets/js/app.e537f6cf.js" as="script"><link rel="preload" href="/myblog/assets/js/2.1acd9fc1.js" as="script"><link rel="preload" href="/myblog/assets/js/14.29c7e94d.js" as="script"><link rel="prefetch" href="/myblog/assets/js/10.00af6b8a.js"><link rel="prefetch" href="/myblog/assets/js/11.311509a4.js"><link rel="prefetch" href="/myblog/assets/js/12.c754f8a6.js"><link rel="prefetch" href="/myblog/assets/js/13.4cb3dc3b.js"><link rel="prefetch" href="/myblog/assets/js/15.f46e4d37.js"><link rel="prefetch" href="/myblog/assets/js/16.efaba0c7.js"><link rel="prefetch" href="/myblog/assets/js/17.b69d9adf.js"><link rel="prefetch" href="/myblog/assets/js/3.3d28f0c8.js"><link rel="prefetch" href="/myblog/assets/js/4.78d7c9d5.js"><link rel="prefetch" href="/myblog/assets/js/5.f4c66f27.js"><link rel="prefetch" href="/myblog/assets/js/6.d5069eb1.js"><link rel="prefetch" href="/myblog/assets/js/7.28162aa8.js"><link rel="prefetch" href="/myblog/assets/js/8.394493cb.js"><link rel="prefetch" href="/myblog/assets/js/9.deedd640.js">
    <link rel="stylesheet" href="/myblog/assets/css/0.styles.318df977.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/myblog/" class="home-link router-link-active"><!----> <span class="site-name">JR-Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/myblog/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习" class="dropdown-title"><!----> <span class="title" style="display:;">学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/5ea030/" class="nav-link">Javascript</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/97fe03/404" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/97fe03/404" class="nav-link">React</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/51014f/" class="nav-link">小程序</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/209fb8/" class="nav-link">前端工程</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/97fe03/" aria-current="page" class="nav-link router-link-exact-active router-link-active">前端组件库</a></li></ul></div></div><div class="nav-item"><a href="/myblog/pages/97fe03/404" class="nav-link">工作</a></div><div class="nav-item"><a href="/myblog/pages/97fe03/404" class="nav-link">生活</a></div> <a href="https://github.com/jiang-gary/myblog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/myblog/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习" class="dropdown-title"><!----> <span class="title" style="display:;">学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/5ea030/" class="nav-link">Javascript</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/97fe03/404" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/97fe03/404" class="nav-link">React</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/51014f/" class="nav-link">小程序</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/209fb8/" class="nav-link">前端工程</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/97fe03/" aria-current="page" class="nav-link router-link-exact-active router-link-active">前端组件库</a></li></ul></div></div><div class="nav-item"><a href="/myblog/pages/97fe03/404" class="nav-link">工作</a></div><div class="nav-item"><a href="/myblog/pages/97fe03/404" class="nav-link">生活</a></div> <a href="https://github.com/jiang-gary/myblog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JavaScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>手写系列</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/pages/5ea030/" class="sidebar-link">实现call,apply,bind</a></li><li><a href="/myblog/pages/db05f4/" class="sidebar-link">实现Promise</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>基础知识</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/pages/14dc86/" class="sidebar-link">原型-原型链-继承</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>React</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>小程序</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/pages/51014f/" class="sidebar-link">webview使用</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端工程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/pages/a88ea4/" class="sidebar-link">pnpm+workspace+changesets构建monorepo工程</a></li><li><a href="/myblog/pages/209fb8/" class="sidebar-link">husyk+commitlint配置提交代码检查与规范</a></li><li><a href="/myblog/pages/d96e68/" class="sidebar-link">standard-version版本自动化工具</a></li><li><a href="/myblog/pages/d03de6/" class="sidebar-link">前端单元测试</a></li><li><a href="/myblog/pages/1b7d18/" class="sidebar-link">Babel认识与应用</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>前端组件库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/pages/97fe03/" aria-current="page" class="active sidebar-link">搭建Taro3组件库</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/myblog/pages/97fe03/#使用-pnpm-的工作空间-workspace-搭建-taro3-ui-流程记录" class="sidebar-link">使用 pnpm 的工作空间（Workspace）搭建 taro3-UI 流程记录</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/myblog/pages/97fe03/#pnpm-的工作空间-workspace-介绍" class="sidebar-link">pnpm 的工作空间（Workspace）介绍</a></li><li class="sidebar-sub-header level3"><a href="/myblog/pages/97fe03/#搭建流程" class="sidebar-link">搭建流程</a></li><li class="sidebar-sub-header level3"><a href="/myblog/pages/97fe03/#整体项目搭建" class="sidebar-link">整体项目搭建</a></li><li class="sidebar-sub-header level3"><a href="/myblog/pages/97fe03/#组件库项目搭建" class="sidebar-link">组件库项目搭建</a></li><li class="sidebar-sub-header level3"><a href="/myblog/pages/97fe03/#demo-项目搭建" class="sidebar-link">demo 项目搭建</a></li><li class="sidebar-sub-header level3"><a href="/myblog/pages/97fe03/#项目工程化" class="sidebar-link">项目工程化</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-e1efabd0><div class="articleInfo" data-v-e1efabd0><ul class="breadcrumbs" data-v-e1efabd0><li data-v-e1efabd0><a href="/myblog/" title="首页" class="iconfont icon-home router-link-active" data-v-e1efabd0></a></li> <li data-v-e1efabd0><span data-v-e1efabd0>学习</span></li><li data-v-e1efabd0><span data-v-e1efabd0>前端组件库</span></li></ul> <div class="info" data-v-e1efabd0><div title="作者" class="author iconfont icon-touxiang" data-v-e1efabd0><a href="https://github.com/jiang-gary" target="_blank" title="作者" class="beLink" data-v-e1efabd0>Jiang Rui</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-e1efabd0><a href="javascript:;" data-v-e1efabd0>2022-08-31</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">搭建Taro3组件库<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="使用-pnpm-的工作空间-workspace-搭建-taro3-ui-流程记录"><a href="#使用-pnpm-的工作空间-workspace-搭建-taro3-ui-流程记录" class="header-anchor">#</a> 使用 pnpm 的工作空间（Workspace）搭建 taro3-UI 流程记录</h2> <h3 id="pnpm-的工作空间-workspace-介绍"><a href="#pnpm-的工作空间-workspace-介绍" class="header-anchor">#</a> pnpm 的工作空间（Workspace）介绍</h3> <blockquote><p>pnpm 内置了对单一存储库（也称为多包存储库、多项目存储库或单体存储库）的支持， 你可以创建一个 workspace 以将多个项目合并到一个仓库中。一个 workspace 的根目录下必须有<a href="https://pnpm.io/zh/pnpm-workspace_yaml" target="_blank" rel="noopener noreferrer">pnpm-workspace.yaml<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><code>文件， 也可能会有</code><a href="https://pnpm.io/zh/npmrc" target="_blank" rel="noopener noreferrer">.npmrc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><code>文件。</code></p></blockquote> <p>目前使用了 pnpm 工作空间功能的最受欢迎的开源项目</p> <p><code>Next,js</code> <code>Vite</code> <code>Vue</code> <code>Element Plus</code> <code>Vant</code></p> <h3 id="搭建流程"><a href="#搭建流程" class="header-anchor">#</a> 搭建流程</h3> <h3 id="整体项目搭建"><a href="#整体项目搭建" class="header-anchor">#</a> 整体项目搭建</h3> <ol><li><p>使用 pnpm 初始化项目</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">mkdir</span> taro-lib-3 <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> taro-lib-3
<span class="token function">pnpm</span> init
</code></pre></div></li> <li><p>安装 estint、prettier、husky</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">pnpm</span> <span class="token function">add</span> eslint prettier <span class="token parameter variable">-D</span>
</code></pre></div></li> <li><p>安装 ts 支持</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">pnpm</span> <span class="token function">add</span> typescript <span class="token parameter variable">-D</span> //安装 ts 模块
</code></pre></div></li> <li><p>monorepo 支持相关的配置</p></li></ol> <ul><li>项目根目录创建 pnpm-workspace.yaml 文件，定义<code>workspace</code>的根目录<div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">touch</span> pnpm-workspace.yaml
<span class="token function">mkdir</span> packages
</code></pre></div></li></ul> <ol start="5"><li><p>初始化 ts 配置</p> <div class="language-sh extra-class"><pre class="language-sh"><code>npx tsc <span class="token parameter variable">--init</span>   //自动生成 tsconfig.json

<span class="token function">touch</span> tsconfig.build.json    // 创建一个全局 ts build 配置文件

// tsconfig.build.json 配置
</code></pre></div></li> <li><p>pnpm 配置</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pnpm install --shamefully-hoist&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">提示</p> <p>配置<code>shamefully-hoist</code>参数为了能在 demo 项目中正常使用组件库项目的依赖</p></div> <blockquote><p>默认情况下，pnpm 创建一个半严格的 node_modules，这意味着依赖项可以访问未声明的依赖项，但 node_modules 之外的模块不行。 通过这种布局，生态系统中的大多数的包都可以正常工作。 但是，如果某些工具仅在提升的依赖项位于根目录的 node_modules 时才有效，您可以将其设置为 true 来为您提升它们。</p></blockquote> <blockquote><p><a href="https://pnpm.io/zh/npmrc#shamefully-hoist" target="_blank" rel="noopener noreferrer">shamefully-hoist 配置说明<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote></li></ol> <h3 id="组件库项目搭建"><a href="#组件库项目搭建" class="header-anchor">#</a> 组件库项目搭建</h3> <ol><li><p>创建并初始化组件源码项目</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token builtin class-name">cd</span> packages
<span class="token function">mkdir</span> tzo-ui <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> tzo-ui
<span class="token function">pnpm</span> init
</code></pre></div></li> <li><p>安装相关依赖</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">pnpm</span> <span class="token function">add</span> react react-dom react-native <span class="token parameter variable">-D</span>   //安装 react 相关依赖

<span class="token function">pnpm</span> <span class="token function">add</span> typescript <span class="token parameter variable">-D</span>   //安装 ts 模块

<span class="token function">pnpm</span> <span class="token function">add</span> @types/classnames @types/node @types/react @types/react-dom @types/react-native <span class="token parameter variable">-D</span>   //安装 ts 类型相关依赖

<span class="token function">pnpm</span> <span class="token function">add</span> rollup rollup-plugin-copy rollup-plugin-typescript2 rollup-plugin-visualizer @rollup/plugin-commonjs @rollup/plugin-json @rollup/plugin-node-resolve <span class="token parameter variable">-D</span>   // 安装 rollup 与相关构建依赖

<span class="token function">pnpm</span> <span class="token function">add</span> @tarojs/components @tarojs/react @tarojs/taro <span class="token parameter variable">-D</span>   //安装 taro 相关依赖

<span class="token function">pnpm</span> <span class="token function">add</span> classnames @lylb/zo-util   //安装需要使用的工具
</code></pre></div></li> <li><p>编写 ts 配置</p> <div class="language-sh extra-class"><pre class="language-sh"><code>npx tsc <span class="token parameter variable">--init</span> //自动生成 tsconfig.json
</code></pre></div><div class="language-json extra-class"><pre class="language-json"><code><span class="token comment">// 编写 tsconfig.build.json</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token string">&quot;../../tsconfig.build&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;target&quot;</span><span class="token operator">:</span> <span class="token string">&quot;es2017&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;module&quot;</span><span class="token operator">:</span> <span class="token string">&quot;es6&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;outDir&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./lib&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;include&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;src/**/*&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>添加入口文件</p></li></ol> <p>上面 ts 配置已经添加编译文件路径，先创建 src 目录</p> <div class="language-sh extra-class"><pre class="language-sh"><code> <span class="token function">mkdir</span> src <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> src
 <span class="token function">touch</span> index.ts
</code></pre></div><ol start="5"><li>进行 rollup 打包构建配置</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code>// 根目录创建 tsconfig.rollup.json
<span class="token function">touch</span> tsconfig.rollup.json

// 创建 config 文件夹 用来储存 rollup 配置文件
<span class="token function">mkdir</span> config <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> config

<span class="token function">touch</span> rollup.config.js
// 编写 rollup 配置文件
</code></pre></div><ol start="6"><li>编写 package.json 中的 scripts 命令</li></ol> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span><span class="token string">&quot;npm run dev:lib&quot;</span>，
    <span class="token property">&quot;dev:lib&quot;</span><span class="token operator">:</span><span class="token string">&quot;tsc --project ./tsconfig.build.json --watch --incremental&quot;</span>，
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span><span class="token string">&quot;yarn run build:rollup &amp;&amp; yarn run build:lib&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build:lib&quot;</span><span class="token operator">:</span><span class="token string">&quot;tsc --project ./tsconfig.build.json&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build:rollup&quot;</span><span class="token operator">:</span><span class="token string">&quot;rollup --config ./config/rollup.config.js&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
</code></pre></div><ol start="7"><li>开始编写组件代码</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">mkdir</span> src <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> src   // 创建代码目录 src 目录
<span class="token function">mkdir</span> common   // 创建公共方法目录
<span class="token function">mkdir</span> components   // 创建组件代码目录
<span class="token function">mkdir</span> style   // 创建样式文件目录
</code></pre></div><h3 id="demo-项目搭建"><a href="#demo-项目搭建" class="header-anchor">#</a> demo 项目搭建</h3> <ol><li>创建 demo 项目</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token builtin class-name">cd</span> packages   // 进入 packages

<span class="token function">npm</span> i <span class="token parameter variable">-g</span> @tarojs/cli   // 安装 tarojs/cli 脚手架 并创建项目

taro init tzo-ui-demo   // 记得选择 <span class="token function">pnpm</span> 初始化项目
</code></pre></div><ol start="2"><li>项目添加 tzo-ui 组件库</li></ol> <div class="language-json extra-class"><pre class="language-json"><code><span class="token comment">// package.json</span>
<span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;tzo-ui&quot;</span><span class="token operator">:</span> <span class="token string">&quot;workspace:\*&quot;</span> <span class="token comment">// 指向 pnpm 空间中的 tzo-ui 项目</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="项目工程化"><a href="#项目工程化" class="header-anchor">#</a> 项目工程化</h3> <p><strong>提示</strong> 可参考文章分类<a href="/myblog/pages/209fb8/">前端工程</a></p> <p>在前面已经介绍安装了<code>eslint</code>和<code>prettier</code> 接下来进行相关配置</p> <ol><li>安装<code>eslint</code>相关依赖</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">pnpm</span> <span class="token function">add</span> eslint-config-taro eslint-config-o2team eslint-import-resolver-custom-alias eslint-plugin-import eslint-plugin-react eslint-plugin-react-hooks <span class="token parameter variable">-D</span>
</code></pre></div><ol start="2"><li>安装<code>prettier</code>相关依赖</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># eslint-config-prettier 用于解决eslint与prettier</span>
<span class="token comment"># eslint-plugin-prettier</span>
<span class="token function">pnpm</span> <span class="token function">add</span> eslint-plugin-prettier eslint-config-prettier <span class="token parameter variable">-D</span>
</code></pre></div><ol start="3"><li>创建 eslint 文件进行配置</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">touch</span> .eslintrc.json  <span class="token comment"># 用于配置规则与规范</span>
<span class="token function">touch</span> .eslintignore  <span class="token comment"># 用于忽略文件配置</span>
</code></pre></div><ol start="4"><li>创建<code>.prettierrc</code>配置文件</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">touch</span> .prettierrc
</code></pre></div><ol start="5"><li>项目添加<code>husky</code>与<code>lint-staged</code></li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">pnpm</span> <span class="token function">add</span> husky lint-staged <span class="token parameter variable">-D</span>
</code></pre></div><p>安装好<code>husky</code>依赖后 添加<code>scripts</code>指令</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;prepare&quot;</span><span class="token operator">:</span> <span class="token string">&quot;husky install&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>执行命令<code>pnpm run prepare</code> 根目录会自动生成 <code>.husky</code>目录</p> <p>添加<code>pre-commit</code>的 hook</p> <div class="language-sh extra-class"><pre class="language-sh"><code>npx husky <span class="token function">add</span> .husky/pre-commit <span class="token string">&quot;npx lint-staged&quot;</span>
</code></pre></div><p>这里用到了<code>lint-staged</code>这个工具 我们需要添加这个配置</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">touch</span> .lintstagedrc.json <span class="token comment"># 根目录添加lint-staged的配置文件</span>
</code></pre></div><div class="language-json extra-class"><pre class="language-json"><code><span class="token comment">// .lintstagedrc.json</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;*.{js,jsx,ts,tsx}&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;prettier --write .&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;eslint  --fix&quot;</span><span class="token punctuation">]</span> <span class="token comment">// 进行格式化与eslint的fix</span>
<span class="token punctuation">}</span>
</code></pre></div><p>此时我们进行代码提交就会运行设置的<code>git hook</code></p> <ol start="6"><li><code>commitlint</code> 与 <code>commitizen</code> 配置</li></ol> <p><strong>安装 commitlint 相关依赖</strong></p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">pnpm</span> <span class="token function">add</span> @commitlint/cli @commitlint/config-conventional <span class="token parameter variable">-D</span>
</code></pre></div><p><strong>添加 commitlint 配置</strong></p> <p>根目录创建<code>commitlint.config.js</code>配置文件 并写入规则 使用<code>@commitlint/config-conventional</code>规则</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;module.exports = {extends: ['@commitlint/config-conventional']}&quot;</span> <span class="token operator">&gt;</span> commitlint.config.js
</code></pre></div><p><strong>安装辅助提交依赖（commitizen）</strong></p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">pnpm</span> <span class="token function">add</span> commitizen cz-conventional-changelog <span class="token parameter variable">-D</span>
</code></pre></div><p>安装好相关依赖后 需要在<code>package.json</code>进行配置</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;script&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;commit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cz&quot;</span>  <span class="token comment">// 添加提交指令 使用cz提交</span>
    <span class="token punctuation">}</span>
    <span class="token property">&quot;config&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;commitizen&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cz-conventional-changelog&quot;</span> <span class="token comment">// 使用这个依赖提供的预设</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>添加 commitizen 的自定义提示信息</strong></p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">pnpm</span> <span class="token function">add</span> cz-customizable <span class="token parameter variable">-D</span>
</code></pre></div><p>当<code>cz-customizable</code>安装好之后 就需要在<code>packgae.json</code>中的<code>commitizen</code>配置</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;config&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;commitizen&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node_modules/cz-customizable&quot;</span> <span class="token comment">// 将提示信息依赖修改成cz-customizable</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>经过上面的配置 就可以自定义提示信息了</p> <p>这就需要新增一个自定义内容文件</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">touch</span> .cz-config.js
</code></pre></div><p><code>.cz-config.js</code>文件就是用来自定义提示信息</p></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">最近更新:</span> <span class="time">9/6/2022, 4:32:53 PM</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/myblog/pages/1b7d18/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Babel认识与应用</div></a> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/myblog/pages/1b7d18/" class="prev">Babel认识与应用</a></span> <!----></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="1016875496@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/jiang-gary" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2023
    <span>Jiang Rui | MIT License</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/myblog/assets/js/app.e537f6cf.js" defer></script><script src="/myblog/assets/js/2.1acd9fc1.js" defer></script><script src="/myblog/assets/js/14.29c7e94d.js" defer></script>
  </body>
</html>
