---
title: standard-versionç‰ˆæœ¬è‡ªåŠ¨åŒ–å·¥å…·
date: 2022-09-06 15:04:29
permalink: /pages/d96e68/
---

## standard-version å®‰è£…ä¸ä½¿ç”¨

[ä¸Šä¸€ç¯‡](/pages/209fb8/)æˆ‘ä»¬å·²ç»ä»‹ç»äº†å¦‚ä½•è¿›è¡Œ `commit-msg` çš„è§„èŒƒæäº¤ä¸æ ¡éªŒ

é‚£æˆ‘ä»¬ git æäº¤ä¹‹åæ€ä¹ˆè¿›è¡Œç‰ˆæœ¬çš„æ§åˆ¶ä¸è‡ªåŠ¨ç”Ÿæˆ `changelog` å‘¢ï¼Ÿé‚£å°±éœ€è¦ä½¿ç”¨åˆ°`standard-version`

### ä»‹ç»

> standard-version æ˜¯ä¸€æ¬¾éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼ˆsemverï¼‰å’Œ commit message æ ‡å‡†è§„èŒƒçš„ç‰ˆæœ¬è‡ªåŠ¨åŒ–å·¥å…·ï¼Œå®ƒè¿˜å¯ä»¥ä½¿ç”Ÿæˆ changelog è‡ªåŠ¨åŒ–ã€‚å¹¶ä¸”å°†æˆ‘ä»¬ç¬¦åˆ Conventional Commits è§„èŒƒçš„æäº¤ä¿¡æ¯æ ¼å¼åŒ–ã€‚

### ä½œç”¨

- è‡ªåŠ¨å‡çº§ç‰ˆæœ¬
- è‡ªåŠ¨æ‰“ tag
- è‡ªåŠ¨ç”Ÿæˆ changelog

### å®‰è£…

::: tip ä½¿ç”¨å‰æ
åœ¨ä½¿ç”¨ standard-version ä¹‹å‰ï¼Œéœ€è¦éµå¾ª Conventional Commit Specifications æ¥è¿›è¡Œæ ‡å‡†åŒ–çš„ commit message ç¼–å†™ã€‚è¿™æ˜¯å› ä¸º standard-version æ˜¯åŸºäº commit ç±»å‹æ¥æ›´æ–°ç‰ˆæœ¬å·çš„ï¼ˆfeature ä¼šæ›´æ–° minor, bug fix ä¼šæ›´æ–° patch, BREAKING CHANGES ä¼šæ›´æ–° majorï¼‰ã€‚commitizen å¯ä»¥å¸®åŠ©æˆ‘ä»¬æäº¤ç¬¦åˆ Conventional Commit Specifications çš„ commit messageã€‚
:::

ä¸Šä¸€ç¯‡ï¼š[commitLint ä¸ commit-msg æ“ä½œ](/pages/209fb8/)

**å®‰è£…**

```sh
npm i standard-version -D
```

**é…ç½®è„šæœ¬**

åœ¨`package.json`æ–‡ä»¶ä¸­æ·»åŠ è„šæœ¬

::: tip
é«˜ç‰ˆæœ¬å¯ä»¥ä½¿ç”¨`npm set-script`è¿›è¡Œè®¾ç½®
:::

```json
// package.json
{
  "scripts": {
    "release": "standard-version"
  }
}
```

### é…ç½®

å®‰è£…å¥½ç›¸åº”ä¾èµ–ä¸æŒ‡ä»¤éœ€è¦è¿›è¡Œé…ç½®

å¢åŠ  `.versionrc` æ–‡ä»¶æ¥æ ¼å¼åŒ– log ï¼Œä½¿æˆ‘ä»¬çš„ `changelog` æ ¹æ® Conventional Commits è§„èŒƒæ›´åŠ è¯­ä¹‰åŒ–ã€‚

```json
{
  "header": "", // å¯è‡ªå®šä¹‰æ·»åŠ ç”Ÿæˆçš„changelogå¤´éƒ¨å†…å®¹
  "types": [
    { "type": "feat", "section": "âœ¨ Features | æ–°åŠŸèƒ½" },
    { "type": "fix", "section": "ğŸ› Bug Fixes | Bug ä¿®å¤" },
    { "type": "init", "section": "ğŸ‰ Init | åˆå§‹åŒ–" },
    { "type": "docs", "section": "âœï¸ Documentation | æ–‡æ¡£" },
    { "type": "style", "section": "ğŸ’„ Styles | é£æ ¼" },
    { "type": "refactor", "section": "â™»ï¸ Code Refactoring | ä»£ç é‡æ„" },
    { "type": "perf", "section": "âš¡ Performance Improvements | æ€§èƒ½ä¼˜åŒ–" },
    { "type": "test", "section": "âœ… Tests | æµ‹è¯•" },
    { "type": "revert", "section": "âª Revert | å›é€€" },
    { "type": "build", "section": "ğŸ“¦ Build System | æ‰“åŒ…æ„å»º" },
    { "type": "update", "section": "ğŸš€ update | æ„å»º/å·¥ç¨‹ä¾èµ–/å·¥å…·å‡çº§" },
    { "type": "tool", "section": "ğŸš€ tool | å·¥å…·å‡çº§" },
    { "type": "ci", "section": "ğŸ‘· Continuous Integration | CI é…ç½®" }
  ],
  // è·³è¿‡ç›¸å…³å†…å®¹
  "skip": {
    "bump": false, // æ˜¯å¦è·³è¿‡æ›´æ”¹ç‰ˆæœ¬
    "changelog": false, // æ˜¯å¦è·³è¿‡ç”Ÿäº§changelog
    "commit": false, // æ˜¯å¦è·³è¿‡è‡ªåŠ¨commit
    "tag": false // æ˜¯å¦è·³è¿‡æ‰“tag
  }
}
```

### ä½¿ç”¨

å½“ä¸€åˆ‡éƒ½é…ç½®å¥½ï¼Œä½¿ç”¨ commitlint è¿›è¡Œä»£ç æäº¤ä¹‹å

å°†ä»£ç åˆå¹¶åˆ°å‘ç‰ˆåˆ†æ”¯ å¯æ‰§è¡Œ`npm run release`

**æŒ‰é»˜è®¤è§„åˆ™å‡çº§ç‰ˆæœ¬å·**

```sh
npm run release # æ‰§è¡Œç‰ˆæœ¬æ›´æ–°
```

è¿™ä¸ªæ—¶å€™å°±ä¼šè‡ªåŠ¨æ›´æ”¹`pacakge.json`ä¸­çš„`version`

`npm`çš„ç‰ˆæœ¬å·æ ¼å¼ï¼š`major.minor.patch`

è‡ªåŠ¨æ›´æ–°çš„ç‰ˆæœ¬å·ä¼šæŒ‰ç…§é»˜è®¤è§„åˆ™å‡çº§`patch`

**æ‰‹åŠ¨è®¾ç½®ç‰ˆæœ¬æ›´æ–°**

1. ç›´æ¥å‡çº§ `major`
   ```json
   "scripts": {
   "release-major": "standard-version --release-as major",
   }
   ```
2. ç›´æ¥å‡çº§`minor`
   ```json
   "scripts": {
   "release-major": "standard-version --release-as minor",
   }
   ```
3. ç›´æ¥å‡çº§`patch`
   ```json
   "scripts": {
   "release-major": "standard-version --release-as patch",
   }
   ```
4. å¼ºåˆ¶æ‰“ä¸€ä¸ªé™æ€ç‰ˆæœ¬å·
   ```json
   "scripts": {
   "release-static": "standard-version --release-as 3.3.3",
   }
   ```
5. å‘å¸ƒç¬¬ä¸€ä¸ªç‰ˆæœ¬

```sh
npm run release -- --first-release
# æˆ–è€…
npx standard-version --first-release
```

### ç¤ºä¾‹

git æäº¤è®°å½•

![standard-version](../../../docs/.vuepress/public/images/standard-version.png)

ç”Ÿæˆçš„`CHANGELOG`æ–‡ä»¶
![changelog](../../.vuepress/public/images/changelog.png)
